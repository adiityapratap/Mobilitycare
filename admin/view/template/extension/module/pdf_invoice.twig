{{ header }}{{ column_left }}
<div id="content">
  <div class="page-header">
    <div class="container-fluid">
      <div class="pull-right">
        <button type="submit" form="form-pdf-invoice" data-toggle="tooltip" title="{{ button_save }}" class="btn btn-primary"><i class="fa fa-save"></i></button>
        <a href="{{ test_generate }}" data-toggle="tooltip" title="Test PDF Generation" class="btn btn-info"><i class="fa fa-file-pdf-o"></i> Test Generate</a>
        <a href="{{ cancel }}" data-toggle="tooltip" title="{{ button_cancel }}" class="btn btn-default"><i class="fa fa-reply"></i></a>
      </div>
      <h1>PDF Invoice Configuration</h1>
      <ul class="breadcrumb">
        {% for breadcrumb in breadcrumbs %}
        <li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
        {% endfor %}
      </ul>
    </div>
  </div>
  <div class="container-fluid">
    {% if error_warning %}
    <div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> {{ error_warning }}
      <button type="button" class="close" data-dismiss="alert">&times;</button>
    </div>
    {% endif %}
    
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title"><i class="fa fa-pencil"></i> PDF Invoice Settings</h3>
      </div>
      <div class="panel-body">
        <form action="{{ action }}" method="post" enctype="multipart/form-data" id="form-pdf-invoice" class="form-horizontal">
          
          <!-- General Settings Tab -->
          <ul class="nav nav-tabs">
            <li class="active"><a href="#tab-general" data-toggle="tab">General</a></li>
            <li><a href="#tab-design" data-toggle="tab">Design</a></li>
            <li><a href="#tab-content" data-toggle="tab">Content</a></li>
          </ul>
          
          <div class="tab-content">
            <!-- General Tab -->
            <div class="tab-pane active" id="tab-general">
              <div class="form-group">
                <label class="col-sm-2 control-label" for="input-status">
                  <span data-toggle="tooltip" title="Enable or disable PDF invoice generation">Status</span>
                </label>
                <div class="col-sm-10">
                  <select name="module_pdf_invoice_status" id="input-status" class="form-control">
                    {% if module_pdf_invoice_status %}
                    <option value="1" selected="selected">Enabled</option>
                    <option value="0">Disabled</option>
                    {% else %}
                    <option value="1">Enabled</option>
                    <option value="0" selected="selected">Disabled</option>
                    {% endif %}
                  </select>
                </div>
              </div>
              
              <div class="form-group">
                <label class="col-sm-2 control-label" for="input-auto-generate">
                  <span data-toggle="tooltip" title="Automatically generate PDF when order is placed">Auto Generate</span>
                </label>
                <div class="col-sm-10">
                  <select name="module_pdf_invoice_auto_generate" id="input-auto-generate" class="form-control">
                    {% if module_pdf_invoice_auto_generate %}
                    <option value="1" selected="selected">Yes</option>
                    <option value="0">No</option>
                    {% else %}
                    <option value="1">Yes</option>
                    <option value="0" selected="selected">No</option>
                    {% endif %}
                  </select>
                </div>
              </div>
              
              <div class="form-group">
                <label class="col-sm-2 control-label" for="input-attach-email">
                  <span data-toggle="tooltip" title="Attach PDF to order confirmation emails">Attach to Email</span>
                </label>
                <div class="col-sm-10">
                  <select name="module_pdf_invoice_attach_email" id="input-attach-email" class="form-control">
                    {% if module_pdf_invoice_attach_email %}
                    <option value="1" selected="selected">Yes</option>
                    <option value="0">No</option>
                    {% else %}
                    <option value="1">Yes</option>
                    <option value="0" selected="selected">No</option>
                    {% endif %}
                  </select>
                </div>
              </div>
              
              <div class="form-group">
                <label class="col-sm-2 control-label" for="input-prefix">
                  <span data-toggle="tooltip" title="Prefix for invoice numbers (e.g., INV-)">Invoice Prefix</span>
                </label>
                <div class="col-sm-10">
                  <input type="text" name="module_pdf_invoice_invoice_prefix" value="{{ module_pdf_invoice_invoice_prefix }}" placeholder="INV-" id="input-prefix" class="form-control" />
                </div>
              </div>
            </div>
            
            <!-- Design Tab -->
            <div class="tab-pane" id="tab-design">
              <div class="form-group">
                <label class="col-sm-2 control-label" for="input-logo">
                  <span data-toggle="tooltip" title="Upload company logo for invoices">Company Logo</span>
                </label>
                <div class="col-sm-10">
                  <input type="file" name="module_pdf_invoice_company_logo" id="input-logo" class="form-control" accept="image/*" />
                  {% if module_pdf_invoice_company_logo %}
                  <br>
                  <img src="{{ module_pdf_invoice_company_logo }}" alt="Current Logo" style="max-width: 200px; max-height: 100px;" />
                  {% endif %}
                </div>
              </div>
              
              <div class="form-group">
                <label class="col-sm-2 control-label" for="input-primary-color">
                  <span data-toggle="tooltip" title="Primary brand color for headers and accents">Primary Color</span>
                </label>
                <div class="col-sm-10">
                  <div class="input-group">
                    <input type="text" name="module_pdf_invoice_primary_color" value="{{ module_pdf_invoice_primary_color }}" id="input-primary-color" class="form-control" />
                    <span class="input-group-addon">
                      <input type="color" value="{{ module_pdf_invoice_primary_color }}" onchange="document.getElementById('input-primary-color').value = this.value;" style="border: none; width: 30px; height: 20px;" />
                    </span>
                  </div>
                </div>
              </div>
              
              <div class="form-group">
                <label class="col-sm-2 control-label" for="input-secondary-color">
                  <span data-toggle="tooltip" title="Secondary color for text and borders">Secondary Color</span>
                </label>
                <div class="col-sm-10">
                  <div class="input-group">
                    <input type="text" name="module_pdf_invoice_secondary_color" value="{{ module_pdf_invoice_secondary_color }}" id="input-secondary-color" class="form-control" />
                    <span class="input-group-addon">
                      <input type="color" value="{{ module_pdf_invoice_secondary_color }}" onchange="document.getElementById('input-secondary-color').value = this.value;" style="border: none; width: 30px; height: 20px;" />
                    </span>
                  </div>
                </div>
              </div>
              
              <div class="form-group">
                <label class="col-sm-2 control-label">
                  <span data-toggle="tooltip" title="Preview of current color scheme">Color Preview</span>
                </label>
                <div class="col-sm-10">
                  <div style="border: 1px solid #ddd; padding: 15px; border-radius: 4px;">
                    <div style="background-color: var(--primary-color, {{ module_pdf_invoice_primary_color }}); color: white; padding: 10px; margin-bottom: 10px; text-align: center;">
                      Header Preview (Primary Color)
                    </div>
                    <div style="color: var(--secondary-color, {{ module_pdf_invoice_secondary_color }}); padding: 10px; border: 1px solid var(--secondary-color, {{ module_pdf_invoice_secondary_color }});">
                      Content Preview (Secondary Color)
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Content Tab -->
            <div class="tab-pane" id="tab-content">
              <div class="form-group">
                <label class="col-sm-2 control-label" for="input-payment-terms">
                  <span data-toggle="tooltip" title="Default payment terms (e.g., Net 30, Due on Receipt)">Payment Terms</span>
                </label>
                <div class="col-sm-10">
                  <input type="text" name="module_pdf_invoice_payment_terms" value="{{ module_pdf_invoice_payment_terms }}" placeholder="Net 30 days" id="input-payment-terms" class="form-control" />
                </div>
              </div>
              
              <div class="form-group">
                <label class="col-sm-2 control-label" for="input-footer">
                  <span data-toggle="tooltip" title="Footer text displayed at bottom of invoices">Footer Text</span>
                </label>
                <div class="col-sm-10">
                  <textarea name="module_pdf_invoice_footer_text" rows="3" placeholder="Thank you for your business!" id="input-footer" class="form-control">{{ module_pdf_invoice_footer_text }}</textarea>
                </div>
              </div>
              
              <div class="form-group">
                <label class="col-sm-2 control-label" for="input-show-serial">
                  <span data-toggle="tooltip" title="Show product serial numbers in invoice">Show Serial Numbers</span>
                </label>
                <div class="col-sm-10">
                  <select name="module_pdf_invoice_show_serial" id="input-show-serial" class="form-control">
                    {% if module_pdf_invoice_show_serial %}
                    <option value="1" selected="selected">Yes</option>
                    <option value="0">No</option>
                    {% else %}
                    <option value="1">Yes</option>
                    <option value="0" selected="selected">No</option>
                    {% endif %}
                  </select>
                </div>
              </div>
              
              <div class="form-group">
                <label class="col-sm-2 control-label">
                  <span data-toggle="tooltip" title="Preview how your invoice will look">Invoice Preview</span>
                </label>
                <div class="col-sm-10">
                  <div class="well">
                    <h4>Sample Invoice Preview</h4>
                    <div style="border: 1px solid #ddd; padding: 20px; background: white; font-family: Arial, sans-serif; font-size: 12px;">
                      <div style="overflow: hidden;">
                        <div style="float: left; width: 50%;">
                          <h2 style="color: {{ module_pdf_invoice_primary_color }}; margin: 0;">{{ config_name }}</h2>
                          <p style="margin: 5px 0;">Since 1992</p>
                        </div>
                        <div style="float: right; text-align: right;">
                          <h1 style="color: {{ module_pdf_invoice_secondary_color }}; margin: 0;">Tax Invoice</h1>
                          <p style="margin: 5px 0;"><strong>Invoice No.:</strong> 12345</p>
                        </div>
                      </div>
                      <div style="clear: both; margin: 20px 0;">
                        <table style="width: 100%; border-collapse: collapse;">
                          <tr style="background: {{ module_pdf_invoice_secondary_color }}; color: white;">
                            <th style="padding: 10px; border: 1px solid #ddd;">Item</th>
                            <th style="padding: 10px; border: 1px solid #ddd;">Qty</th>
                            <th style="padding: 10px; border: 1px solid #ddd;">Price</th>
                          </tr>
                          <tr>
                            <td style="padding: 8px; border: 1px solid #ddd;">Sample Product</td>
                            <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">1</td>
                            <td style="padding: 8px; border: 1px solid #ddd; text-align: right;">$100.00</td>
                          </tr>
                        </table>
                      </div>
                      <div style="text-align: center; color: #666; font-size: 10px; margin-top: 20px; border-top: 1px solid {{ module_pdf_invoice_primary_color }}; padding-top: 10px;">
                        {{ module_pdf_invoice_footer_text }}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
// Color picker functionality
$(document).ready(function() {
    $('input[type="color"]').change(function() {
        var targetId = $(this).closest('.input-group').find('input[type="text"]').attr('id');
        $('#' + targetId).val($(this).val());
        updatePreview();
    });
    
    $('input[type="text"][name*="color"]').on('input', function() {
        var colorValue = $(this).val();
        if (colorValue.match(/^#[0-9A-F]{6}$/i)) {
            $(this).closest('.input-group').find('input[type="color"]').val(colorValue);
            updatePreview();
        }
    });
    
    function updatePreview() {
        var primaryColor = $('input[name="module_pdf_invoice_primary_color"]').val();
        var secondaryColor = $('input[name="module_pdf_invoice_secondary_color"]').val();
        
        $('.well h2').css('color', primaryColor);
        $('.well h1').css('color', secondaryColor);
        $('.well th').css('background-color', secondaryColor);
        $('.well .footer-preview').css('border-top-color', primaryColor);
    }
});
</script>

{{ footer }}